# 質問生成アルゴリズム Q1: パラダイム構造準拠型

## 概要

記述素空間の質問到達候補から網羅的に質問を生成し、パラダイム群の遷移構造に基づいて各質問に役割を付与するアルゴリズム。

## 入力

- 記述素空間（記述素展開アルゴリズムの出力）
- パラダイム群（パラダイム発見アルゴリズムの出力。メインパス、サブパス、各パラダイムの記述素、緊張解消状況を含む）

## 出力

- 質問群（ans 写像、役割、大区分情報付き）

## 使用規則

- 記述素直接変換型
- パラダイム駆動型
- 緊張解消型
- 大区分段階型
- 前提事実

## 手順

### Step 1: 質問候補の網羅的生成

規則「記述素直接変換型」を適用し、記述素空間の全質問到達候補から質問を生成する。

全ての質問は記述素空間内の記述素に基づくものでなければならない。正答が「はい」となる質問だけでなく、「いいえ」や「関係ない」となる質問も含める。「いいえ」の質問は、T のもとで否定される記述素に対応する。「関係ない」の質問は、T に対して影響しない記述素に対応する。

プレイヤーが自然に問いたくなるにもかかわらず対応する記述素が存在しない質問がある場合、それは記述素空間（展開アルゴリズム）の不足を示す。Q1 がそのような質問を独自に追加することはしない。

### Step 2: パラダイムごとの質問の拡充

各パラダイムについて、規則「パラダイム駆動型」を適用し、そのパラダイムに関連する質問を拡充する。

1. パラダイムの鍵記述素に対応する質問が Step 1 に含まれていることを確認する。不足があれば追加する。
2. 鍵記述素の周辺（同じ Ps/Pt の記述素から展開された記述素群）から、パラダイム内の探索を支える質問を追加する。同じ領域に対して異なる角度からアプローチする質問を意識的に含める。

### Step 3: アノマリー導入質問の設計

各パラダイム P_i（T を除く）に対して、アノマリーを O に導入できる質問を設計する。

質問の effect が以下の両方を含む構造を持つこと:
- P_pred(P_i, d) と真値が一致する記述素（同化で H が正解方向に動き、質問がオープンする理由となる）
- P_pred(P_i, d) と真値が食い違う記述素（回答により O に入り、アノマリーとなる）

1. P_i の判定域の記述素を、P_pred と真値の一致/不一致で分類する
2. 一致する記述素と不一致の記述素の組み合わせで、両方に自然に言及できる質問を検討する
   - 記述素間に意味的な関連（同じ場面、同じ行為、因果的な隣接）があることが望ましい
3. 自然な質問が構成できる組み合わせについて、質問を生成し ans 写像を定義する
4. 生成された質問の数が、各 P_i に対してシフトに十分なアノマリーを蓄積できることを確認する

Step 1〜2 で既に生成された質問の中に該当するものがあれば、それを流用してよい。不足する場合のみ新規に生成する。

### Step 4: 役割の付与

規則「パラダイム駆動型」「緊張解消型」を適用し、Step 1〜3 で生成された全質問に役割を付与する。一つの質問に複数の役割が該当する場合がある。

- **探索**: 現在のパラダイム内の記述素に対応し、パラダイム内の理解を深める質問。正答が「いいえ」「関係ない」の質問も含む（仮説の排除として機能する）。
- **蓄積**: 現在のパラダイムでは吸収しきれない記述素に対応し、説明力への圧力を蓄積する質問。直接的にはシフトを起こさないが、次の遷移の準備となる。
- **駆動**: パラダイム遷移を駆動する緊張を解消する記述素に対応する質問。規則 C により特定する。
- **分岐**: サブパスのパラダイムに特有の記述素に対応し、代替解釈へ誘導する質問。

### Step 5: 大区分配置

規則「大区分段階型」を適用し、全質問を大区分（I / II / III）に分類する。

### Step 6: 前提事実の割り当て

規則「前提事実」を適用し、各質問の prerequisites を設定する。

1. 各質問について、その質問が論理的に成立するために確定済みであることを要求する記述素を特定する
   - 「この記述素が確定していなければ、この質問を聞くこと自体が意味をなさない」という関係を基準とする
2. 特定された記述素を prerequisites として設定する
3. prerequisites がない質問（初期オープンの候補や、前提なしで成立する質問）はそのまま空とする

### Step 7: 検証

以下を確認する:

- 各パラダイム P_i（T を除く）に対して、アノマリー導入質問が存在するか（ゲーム進行条件）
- 各パラダイムに十分な数の探索質問があるか（通常科学フェーズの充実）
- 各遷移に駆動質問が存在するか（遷移の成立）
- 各サブパスの分岐・合流を支える質問があるか
- 全体として、プレイヤーが多数の質問を通じて試行錯誤できる量があるか
- prerequisites が init_questions および open_questions での質問の到達を妨げないか（前提の記述素がゲーム進行で確定可能であること）

不足がある場合、Step 2 に戻って該当するパラダイムの質問を拡充する。

#### Step 7 と S1 Step 5b の関係

Step 6 で設定した prerequisites は質問のオープン条件を厳しくするため、S1 が確保した anomaly 発掘連鎖を壊す可能性がある。Step 7 の prerequisites 検証（前提の記述素がゲーム進行で確定可能であること）は静的な到達可能性の確認であるが、動的な発掘連鎖の検証は S1 Step 5b が担当する。

統合アルゴリズムの反復ループにおいて、Step 6 の適用後は S1 Step 5b を再実行し、prerequisites の追加により発掘不可能になった質問がないことを検証する必要がある。検証 NG の場合、S1 Step 5b の対処法（構造的対処を第一選択とする）に従う。

## 備考

- 名称は暫定的なもの
- 本アルゴリズムの性質については theory/terms.md「アルゴリズムの性質」を参照
