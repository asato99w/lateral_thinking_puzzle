# パラダイムシフトの機構

## 概要

パラダイムシフトは、現在のパラダイムが観測を説明しきれなくなったときに発生する。この機構は二つの独立した判定から構成される。

1. **シフト発動**: 現在のパラダイムに対するアノマリーの蓄積が閾値を超えたか（いつシフトするか）
2. **シフト先決定**: 候補パラダイムの中で観測を最もよく説明するものはどれか（どこにシフトするか）

これらは異なる目的を持つため、それぞれ独立した関数として定義する。

## 緊張関数 tension(O, P)

現在のパラダイム P に対するアノマリーの蓄積度を測る。

### 定義

**tension(O, P) = |{d ∈ O ∩ D(P) | P(d) ≠ O(d)}|**

O の観測のうち、P の所属記述素に含まれ、かつ P の予測と矛盾するもの（アノマリー）の数。

### 性質

- O は単調に拡大し、一度 O に入った記述素は除かれない。アノマリーの寄与は非負であるため、tension は**単調非減少**である。
- O と P のみから計算され、H に依存しない（客観的な判定）。
- D(P) に含まれない観測は tension に寄与しない。これにより、パラダイムのスコープ外の観測（他のパラダイムの固有記述素など）が緊張を生むことはない。

### シフト発動条件

**tension(O, P_current) > threshold**

threshold は設計パラメータとして調整する。

## 整合性関数 alignment(O, P)

候補パラダイム P が観測 O をどれだけ説明できるかを測る。

### 定義

**alignment(O, P) = |{d ∈ O ∩ D(P) | P(d) = O(d)}| / |O|**

分母を |O|（全観測数）とすることで、カバレッジ（P がどれだけの観測を自らのスコープに含むか）と一致率（スコープ内での正しさ）の両方を反映する。

### 性質

- 共有質問で蓄積された観測は、シフト先のパラダイムの alignment を直接高める。
- カバレッジが低いパラダイム（少数の記述素しか持たない）が過大評価されない。
- alignment は時間的な単調性を持たない（比較指標であり、蓄積量ではない）。

### シフト先の決定

**P_new = argmax_{P' ≠ P_current} alignment(O, P')**

ただし alignment(O, P_new) > alignment(O, P_current) であること。この条件を満たさない場合は危機状態とし、P_current を維持して継続する。

## シフト手続き

1. 質問への回答により O を更新する
2. 同化（現在のパラダイムの関係構造に基づく H の伝播）
3. tension(O, P_current) > threshold であればシフト判定へ
4. 各候補 P' に対して alignment(O, P') を計算
5. 最良の P_new が P_current より高ければシフトを実行し、P_new の関係構造で H を再構成する
6. そうでなければ P_current を維持（危機状態）

## 共有質問と架橋質問の役割

二つの質問タイプがシフト機構において相補的に機能する。

- **架橋質問**: 効果が複数パラダイムの固有記述素にまたがる。現在のパラダイムの D(P) 内で矛盾する効果を含みうるため、アノマリーを蓄積し、tension を高める。シフトを**引き起こす**。
- **共有質問**: 効果が共有記述素のみに属する。現在のパラダイムと矛盾しないため tension は変化しないが、シフト先の alignment を高める。シフトの**方向を決定づける**。

## データの健全性条件

### 完全確定におけるアノマリーの単調減少

メインパスのパラダイム列 P₁ → P₂ → ... → T に対して、完全確定（全記述素が O* または R* に振り分けられた状態）のもとでのアノマリー数が単調に減少すること。

**anomalies(O*, P₁) > anomalies(O*, P₂) > ... > anomalies(O*, T) = 0**

- P₁ はアノマリーが最も多い → 最初にシフトが発生する
- T はアノマリーがゼロ → P(O | T) = 1 が構造的に保証される
- 各パラダイムは前のパラダイムより少ないアノマリーを持つ → シフトのたびに安定性が増す

この条件はデータ設計時に検証すべき構造的要件である。
