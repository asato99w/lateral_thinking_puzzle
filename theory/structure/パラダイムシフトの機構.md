# パラダイムシフトの機構

## 概要

パラダイムシフトは、現在のパラダイムが観測を説明しきれなくなったときに発生する。この機構は二つの独立した判定から構成される。

1. **シフト発動**: 現在のパラダイムに対するアノマリーの蓄積が閾値を超えたか（いつシフトするか）
2. **シフト先決定**: 候補パラダイムの中で観測を最もよく説明するものはどれか（どこにシフトするか）

これらは異なる目的を持つため、それぞれ独立した関数として定義する。

## 緊張関数 tension(O, P)

現在のパラダイム P に対するアノマリーの蓄積度を測る。

### 定義

**tension(O, P) = |{d ∈ O ∩ D(P) | P(d) ≠ O(d)}|**

O の観測のうち、P の所属記述素に含まれ、かつ P の予測と矛盾するもの（アノマリー）の数。

### 性質

- O は単調に拡大し、一度 O に入った記述素は除かれない。アノマリーの寄与は非負であるため、tension は**単調非減少**である。
- O と P のみから計算され、H に依存しない（客観的な判定）。
- D(P) に含まれない観測は tension に寄与しない。これにより、パラダイムのスコープ外の観測（他のパラダイムの固有記述素など）が緊張を生むことはない。

### シフト発動条件

**tension(O, P_current) > threshold(P_current)**

threshold(P) はパラダイムごとに、完全確定 O* と近傍 N(P) から導出される。詳細は「パラダイムの近傍」を参照。

## 整合性関数 alignment(H, P)

候補パラダイム P が暫定理論 H とどれだけ整合するかを測る。

### 定義

**alignment(H, P) = (Σ_{d∈D⁺(P)} H(d) + Σ_{d∈D⁻(P)} (1 - H(d))) / |D(P)|**

D⁺ の記述素は H(d) が 1 に近いほど、D⁻ の記述素は H(d) が 0 に近いほど、alignment が高くなる。

### 性質

- H は連続値（0〜1）であるため、同点が実質的に発生しない。
- 同化により H は現パラダイムの予測方向に押されているため、構造的に近いパラダイムが自然に高スコアになる。
- 未観測・未同化の記述素は H(d) = 0.5 で中立的に寄与する。D(P) が大きいだけでは有利にならない。
- 観測が蓄積すると H が真値に収束し、T が自然に最大になる。跳躍は情報量が十分なときにのみ発生する。

### シフト先の決定

シフト候補は、現パラダイムの近傍のうちアノマリーがより少ないパラダイムに限定する。

**候補 = { P' ∈ N(P_current) | anomalies(O, P') < anomalies(O, P_current) }**

**P_new = argmax_{P' ∈ 候補} alignment(H, P')**

候補が空の場合は危機状態とし、P_current を維持して継続する。

P_current は候補に含まれない。これにより、シフトは常にアノマリーが減少する方向にのみ発生し、ループが構造的に不可能になる。alignment は候補内での選択に用いられ、H が反映するプレイヤーの認知状態に最も整合するパラダイムが選ばれる。

## シフト手続き

1. 質問への回答により O を更新する
2. 同化（現在のパラダイムの関係構造に基づく H の伝播）
3. tension(O, P_current) > threshold(P_current) であればシフト判定へ
4. 候補 = { P' ∈ N(P_current) | anomalies(O, P') < anomalies(O, P_current) }
5. 候補の中で alignment(H, P') が最大の P_new にシフトし、P_new の関係構造で H を再構成する
6. 候補が空ならば P_current を維持（危機状態）

## 共有質問と架橋質問の役割

二つの質問タイプがシフト機構において相補的に機能する。

- **架橋質問**: 効果が複数パラダイムの固有記述素にまたがる。現在のパラダイムの D(P) 内で矛盾する効果を含みうるため、アノマリーを蓄積し、tension を高める。シフトを**引き起こす**。
- **共有質問**: 効果が共有記述素のみに属する。現在のパラダイムと矛盾しないため tension は変化しないが、シフト先の alignment を高める。シフトの**方向を決定づける**。

## データの健全性条件

### 完全確定におけるアノマリーの単調減少

メインパスのパラダイム列 P₁ → P₂ → ... → T に対して、完全確定（全記述素が O* または R* に振り分けられた状態）のもとでのアノマリー数が単調に減少すること。

**anomalies(O*, P₁) > anomalies(O*, P₂) > ... > anomalies(O*, T) = 0**

- P₁ はアノマリーが最も多い → 最初にシフトが発生する
- T はアノマリーがゼロ → P(O | T) = 1 が構造的に保証される
- 各パラダイムは前のパラダイムより少ないアノマリーを持つ → シフトのたびに安定性が増す

この条件はデータ設計時に検証すべき構造的要件である。
