# 発掘連鎖到達性

## 概要

P_init の safe 質問群からの同化連鎖によって、全 anomaly 質問が段階的に発掘可能であることを保証する規則。

「anomaly 到達性充足」がパラダイム単位の静的な到達可能性を保証するのに対し、本規則はゲーム全体の動的な進行における発掘可能性を保証する。

## 背景

anomaly 到達性充足（静的分析）と実際のゲーム進行（動的シミュレーション）にはギャップがある:

1. 静的に到達可能でも、ゲーム進行の順序制約で実際には発掘されないケースがある
2. パラダイムシフト後の同化による到達は、各パラダイム独立の静的分析では捉えきれない

本規則はこのギャップを埋めるために、ゲーム進行全体を通じた動的な発掘可能性を要求する。

## 定義

- **safe 質問**: effect の全 (d, v) が P_init の予測と矛盾しない質問
- **anomaly 質問**: effect に P_init の予測と矛盾する (d, v) を含む質問
- **発掘連鎖**: safe 質問の回答 → 同化による H 変化 → open_questions による新規オープン → anomaly 質問の発見、という連鎖。発掘された anomaly 質問の回答も連鎖に加わる

## 検証手順

1. init_questions で得られる safe 質問のみを初期オープンとする
2. safe 質問を順次回答し、同化による H 変化を追跡する
3. H 変化で新たにオープンされる質問を検出する
4. 新規オープンの中で anomaly 質問があれば「発掘」として記録する
5. 発掘された anomaly 質問も回答対象に加え、連鎖を続行する
6. 連鎖が停止するまで繰り返す

## 検証条件

```
発掘連鎖シミュレーションの結果:
  全 anomaly 質問が発掘可能であること
```

## 不充足時の原因分類

### 類型 D（発掘連鎖の断絶）

opening_reach（静的分析）では到達可能と判定されるが、ゲーム進行の順序制約により実際には発掘されないケース。

原因:
- anomaly 質問の effect の開放記述素に対して、同化連鎖で H が十分に動かない
- 発掘に必要な先行質問が開かない（循環依存）
- パラダイムシフトの未発生により、到達経路が活性化しない

### 類型 E（到達経路の不在）

opening_reach（静的分析）でも到達不能なケース。anomaly 到達性充足の不足類型 A〜C に対応する。

## 不充足時の対処

対処はデータ側（空間設計・質問設計）で行う。relations や effect は内容から自然に見出されるものであり、恣意的な修正ではなく、生成プロセスにおいて発掘可能性を意識する:

1. **空間生成時（E1/E2）**: anomaly 質問の effect 記述素に対する到達経路を意識し、中間的な記述素の合成（架け橋合成）や関係の設計で連鎖を確保する
2. **質問設計時（S1/Q2）**: 新規 anomaly 質問の effect に、同化連鎖で H が動く開放記述素を含める。偶然の開きの構造が成立することを確認する
3. **検証**: anomaly_discovery.py を実行し、全 anomaly 質問の発掘可能性を確認する

## anomaly 到達性充足との関係

| 観点 | anomaly 到達性充足 | 発掘連鎖到達性 |
|------|-------------------|---------------|
| 分析単位 | パラダイム単位 | ゲーム全体 |
| 手法 | 静的（R(P) の推移閉包） | 動的（シミュレーション） |
| 検証ツール | opening_reach.py | anomaly_discovery.py |
| 保証内容 | 構造的に到達可能 | 実際に発掘される |

両規則は相補的であり、anomaly 到達性充足は発掘連鎖到達性の必要条件（構造が整っていなければ動的にも到達しない）だが十分条件ではない。

## 備考

- 本規則は anomaly_discovery.py の検証ロジックを理論的規則として定式化したもの
- S1 アルゴリズムの Step 5b（動的再検証）の終了条件として使用される
- init_questions の純化（anomaly 質問の除外）が前提。init_questions に anomaly 質問が含まれると、発掘連鎖の起点が不正確になる
