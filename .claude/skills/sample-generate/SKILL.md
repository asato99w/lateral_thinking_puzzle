# /sample-generate — サンプル生成（正式フロー）

## 概要

統合アルゴリズムに従い、入力からサンプル文書（01〜07）を生成する。
サンプルの再生成が必要な場合の正式フローはこのスキルを使う。

## 引数

- `$ARGUMENTS`: パズルのタイトル（例: `ウミガメのスープ`）

## 事前条件

- 問題文（S）と真理論（T）が提示されていること
- 対象パズルの NNN 連番が決まっていること（既存の場合は次の反復連番を付与）

## 手順

### 1. ディレクトリ作成

```
samples/NNN_タイトル/NN_YYYYMMDD_統合アルゴリズム適用/
```

- NNN: パズル連番（既存なら既存の NNN を使用、新規なら次の連番）
- NN: 反復連番（既存パズルなら最後の反復 +1、新規なら 01）
- YYYYMMDD: 本日の日付

### 2. ファイル生成（順次）

以下のファイルを統合アルゴリズム（`theory/integration/algorithms/統合アルゴリズム.md`）に従い順次生成する。各ファイルの冒頭に使用した規則・アルゴリズム名を明記する。

| ファイル | Phase | 参照規則 | 内容 |
|---------|-------|---------|------|
| 01_入力.md | - | - | S, T, Ps, Pt の定義 |
| 02_記述素展開.md | Phase 1 Step 1-1 | 空間構築 | 記述素空間 F' の生成 |
| 03_パラダイム発見.md | Phase 1 Step 1-2 | 空間構築 | メインパス・サブパスの発見 |
| 04_内部構造構成.md | Phase 1 Step 1-3 + Phase 2 | 空間構築, 質問構造設計 | P_pred, R(P) の構成 + ゲート辺追加 |
| 05_質問生成.md | Phase 3 | 質問生成 | 質問群の生成（prerequisites, 役割, 大区分付き） |
| 06_形式化.md | - | - | JSON 変換可能な完全データ（`samples/_template.md` の要件に準拠） |
| 07_検証.md | Phase 4 | 補完検証, 多層構造検証, シフト方向検証 | 下記の検証項目を実施 |

### 3. 07_検証.md の検証項目

Phase 4 の各 Step を順に実施する:

| Step | 検証名 | 内容 |
|------|--------|------|
| 4a | 完全性検証 | 各パラダイムのアノマリー記述素が質問群でカバーされているか |
| 4b | 同化接続性・発掘連鎖 | スキップ（適用保留中） |
| 4c | 多層構造検証 | Q(P) の層構造品質 |
| 4d | シフト方向検証 | 遷移方向スコア・駆動率＋シミュレーション |
| 4e | 到達パス検証 | ゲームシミュレーションによる行き詰まり検出 |
| 4f | 構造的品質診断 | 前提閉包性（L3-6）＋層間連鎖性（L3-7） |
| 4g | 不足ルーティング | 不足があれば差し戻し先を特定し報告 |

### 4. 反復判定

Step 4e（到達パス検証）が NG の場合:
1. Step 4f の診断結果から原因候補を特定
2. Step 4g で差し戻し先を決定
3. ユーザーに報告し、反復の要否を確認

## 参照ファイル

- `theory/integration/algorithms/統合アルゴリズム.md` — 全体手順
- `theory/integration/rules/` — 各統合ルール
- `samples/_template.md` — 命名規則・ファイル要件

## 注意事項

- 06_形式化.md は省略・曖昧さ不可。`_template.md` の完全性基準を厳守する
- 各ファイルで参照した規則名を冒頭に明記する
- Phase 2（質問構造設計）はアノマリーからの逆算が核心。安易なボトムアップ生成をしない
