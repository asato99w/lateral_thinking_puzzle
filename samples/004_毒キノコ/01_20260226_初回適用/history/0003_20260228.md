# 調律ラウンド 0003 — 2026-02-28

## 検証結果（修正前）

| 検証 | 結果 |
|------|------|
| L2-0 | OK |
| L2-1 | OK |
| L2-4 | OK |
| L2-5 | NG (51/51 P1停滞) |

## 診断

**対象**: L2-5（到達パス） — 最後の NG

**根本原因**: シミュレーションが複数段階で停滞。L3-6/L3-7 メトリクスの診断から複合的な原因を特定。

1. **init_question_ids 未設定**: JSON に `init_question_ids` フィールドがなく、シミュレーション開始時にオープン質問数が 0 → 即停滞
2. **P1 anomaly_reach 不足**: R(P1) に Fs-08 からのアノマリー到達経路がなく、q14（M-01 生産）等のアノマリー質問がオープン不能
3. **P2 ブートストラップ問題**: P2 シフト後 anomaly = 0 のため anomaly_reach が空。M-01 からの経路が未接続
4. **S1→P2 resolve 不足**: resolve_cap(S1→P2) = 5 だがランダムシミュレーション時の resolve が閾値に到達不能
5. **P2→P3 resolve 不足**: resolve_cap(P2→P3) = 6 だが P2 での質問連鎖が長く、全アノマリーの観測が困難
6. **P1→S1 シフトによる q14 喪失**: q08 回答時に P1→S1 シフトが即座に発生（effective_n=0）。q14 は Fs-08 の anomaly_reach 経由でしかオープンしないため、シフト時点でオープンリストに未追加 → carry-over されず喪失
7. **S1 ブートストラップ問題**: P1 で全質問消費後にシフトが発生するケースで、Q(S1) の質問が全て回答済み → S1→P2 シフトをトリガーする質問がない

**アルゴリズム不備の検討**: 修正は init_question_ids 設定、関係辺追加、shift_threshold 設定、paradigms 拡大の組み合わせで対処可能。アルゴリズムの修正分類の適用範囲内。

## 修正内容

修正分類: **パラダイム構造**（init_question_ids + 関係辺追加 + shift_threshold + パラダイム所属変更）

### 初期設定

| フィールド | 変更 |
|---|---|
| init_question_ids | 新規追加: ["q01", "q02", "q03", "q06", "q07", "q08", "q14"] |

**根拠**: シミュレーション開始に必要。P1 の safe 質問（prereqs なし、P1 paradigm）+ q14（M-01 生産、P2 ブートストラップに必要）。q14 は Fs-08 anomaly_reach 経由でしかオープンしないが、P1→S1 シフト（effective_n=0）が q08 回答と同時に発生するため、通常のオープンでは q14 がリストに入る前にシフトが起きる。init に含めることで確実にオープンを保証。

### P1 修正

| フィールド | 変更 |
|---|---|
| relations（追加） | Fs-08→Ft-08(0.7), Fs-08→D-01(0.7), Fs-08→Ft-11(0.7), Fs-08→M-03(0.7), Fs-08→Ft-10(0.7), D-01→M-01(0.7) |

**根拠**: Fs-08（キノコを食べた）から各アノマリー記述素への anomaly_reach 経路を構築。D-01→M-01 で q14 の効果 M-01 への到達を確保。

### S1 修正

| フィールド | 変更 |
|---|---|
| relations（追加） | Ft-11→Ft-13(0.7) |

**根拠**: P1 で全質問消費後に P1→S1 シフトが発生するケースに対応。Ft-11 は S1 のアノマリー記述素であり、anomaly_reach 経由で Ft-13（q11 の効果）へ到達。これにより q11 が S1 でオープン → 回答によりシフトがトリガーされる。

### q14 修正

| フィールド | 変更前 | 変更後 |
|---|---|---|
| paradigms | [P2] | [P2, P1] |

**根拠**: q14（M-01 生産）を P1 でオープン可能にする。M-01 は P2 のブートストラップに不可欠。

### q11 修正

| フィールド | 変更前 | 変更後 |
|---|---|---|
| paradigms | [P2] | [P2, S1] |

**根拠**: P1 で全質問消費後の S1 ブートストラップ問題に対応。q11（Ft-13 生産、prereqs=[Ft-11]）を S1 でオープン可能にし、S1→P2 シフトをトリガーする質問を確保。

### P2 修正

| フィールド | 変更 |
|---|---|
| shift_threshold | 新規追加: 1 |
| relations（追加） | M-01→Ft-09(0.7), M-01→Ft-05(0.7), Ft-05→Ft-07(0.7), Ft-05→Ft-18(0.7), Ft-05→B-03(0.7), Ft-18→Ft-19(0.7), Ft-13→D-02(0.7) |

**根拠**:
- shift_threshold = 1: resolve_cap(S1→P2) = 5 だがランダムシミュレーションで全アノマリー観測は保証不能。Fs-16（q06 で常に観測）のみで resolve=1 ≥ 1 を確保
- 関係辺: M-01（q14 で生産）から anomaly_reach を拡張。Ft-09, Ft-05 への接続で質問連鎖を構築

### P3 修正

| フィールド | 変更 |
|---|---|
| shift_threshold | 新規追加: 3 |

**根拠**: resolve_cap(P2→P3) = 6 だが、P2 での質問連鎖が長く全 6 アノマリーの観測は保証不能。M-01 + Ft-09 + Ft-05（q14→q15→q16 の 3 質問連鎖）で resolve=3 ≥ 3 を確保。

## 検証結果（修正後）

| 検証 | 結果 | 変化 |
|------|------|------|
| L2-0 | OK | 維持 |
| L2-1 | OK | 維持 |
| L2-4 | OK | 維持 |
| L2-5 | OK (51/51 T到達) | 改善 |
