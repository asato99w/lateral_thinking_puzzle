# サンプル生成テンプレート

## 概要

水平思考パズルの題材に対して、理論フレームワークの各アルゴリズムを適用し、POC に取り込み可能なデータを生成するまでの手順とファイル構成。

## ディレクトリ構成

```
samples/NNN_タイトル/
  01_入力.md          ← Ps, Pt の定義
  02_記述素展開.md    ← 記述素空間の生成
  03_パラダイム発見.md ← パラダイム群の発見
  04_質問生成.md      ← 質問群の生成
  05_形式化.md        ← POC 取り込み用の構造化データ
```

各ファイルは前のステップの出力を入力として使用する。05_形式化.md は 02〜04 の出力を統合し、POC の JSON データに変換可能な形式に整理する。

---

## 01_入力.md

対応する quizzes/NNN_*.md の内容を元に、Ps（問題文の命題分解）と Pt（真相の命題分解）を定義する。

### テンプレート

```markdown
# 入力

## 問題文

（問題文をここに記載）

## Ps（問題文の命題分解）

| ID | 内容 |
|----|------|
| Ps-1 | （命題1） |
| Ps-2 | （命題2） |
| ... | ... |

## 真相

（真相のストーリーをここに記載）

## Pt（真相の命題分解）

| ID | 内容 |
|----|------|
| Pt-1 | （命題1） |
| Pt-2 | （命題2） |
| ... | ... |
```

---

## 02_記述素展開.md

使用する展開アルゴリズム（E1 等）を明記し、Ps と Pt に対して適用する。

### テンプレート

```markdown
# 記述素展開：アルゴリズム（名称）適用

## ステップ 1: Ps への展開（→ Fs）

### Ps-1「（内容）」

単一記述素規則:
- Fs-01 [規則名] （記述素の内容）
- Fs-02 [規則名] （記述素の内容）
- ...

異常性検出:
- Fs-XX [異常性検出] （内容）

（各 Ps について繰り返す）

### 緊張関係抽出

- T1 [緊張: Ps-X × Ps-Y] （緊張の内容）
- ...

## ステップ 2: Pt への展開（→ Ft）

（Ps への展開と同様の構造）

## ステップ 3: 合成（→ D）

### Fs 内の合成
- D-01 [合成: Fs-XX + Fs-YY] （内容）
- ...

### Ft 内の合成
- D-XX [合成: Ft-XX + Ft-YY] （内容）
- ...

### Fs × Ft の合成
- D-XX [合成: Fs-XX + Ft-YY] （内容）
- ...

## 記述素一覧

| 領域 | ID 範囲 | 記述素数 |
|------|---------|---------|
| Ps | Ps-1 〜 Ps-N | N |
| Fs | Fs-01 〜 Fs-XX, T1 〜 TN | XX |
| Pt | Pt-1 〜 Pt-N | N |
| Ft | Ft-01 〜 Ft-XX | XX |
| D | D-01 〜 D-XX | XX |
| **合計** | | **XXX** |
```

**POC 取り込みに必要な情報**: 記述素一覧の全 ID（→ all_descriptor_ids）、Ps の一覧（→ ps_values）

---

## 03_パラダイム発見.md

使用する発見アルゴリズム（A 等）を明記し、記述素空間に対して適用する。

### テンプレート

```markdown
# パラダイム発見：アルゴリズム（名称）適用

入力: 記述素空間（02_記述素展開.md）

## Step 1: 緊張構造の把握

（緊張関係 T1〜TN の分析）

## Step 2: メインパスの発見

### P1:（名称）

- 説明: （このパラダイムの世界理解）
- 鍵記述素: Fs-XX, Fs-YY, ...
- 解消する緊張: （該当する場合）
- 未解消の緊張: T1, T2, ...

### P2:（名称）

（同様の構造）

...

### メインパス

P1 → P2 → ... → PN

## Step 3: サブパスの発見

### S1:（名称）

- 分岐元: P1
- 説明: （代替解釈の内容）
- 鍵記述素: Fs-XX, ...

...
```

**POC 取り込みに必要な情報**: 各パラダイムの ID・名称・鍵記述素（→ paradigms の基礎情報、init_paradigm）

---

## 04_質問生成.md

使用する質問生成アルゴリズム（Q1 等）を明記し、記述素空間とパラダイム群に対して適用する。

### テンプレート

```markdown
# 質問生成：アルゴリズム（名称）適用

入力:
- 記述素空間（02_記述素展開.md）
- パラダイム群（03_パラダイム発見.md）

## 質問一覧

### （セクション名：パラダイムまたは主題ごと）

| ID | 質問 | 正答 | 対象記述素 |
|----|------|------|-----------|
| q01 | （質問文） | はい/いいえ/関係ない | Fs-XX |
| q02 | （質問文） | はい | Fs-YY, Fs-ZZ |
| ... | ... | ... | ... |

（セクションを繰り返す）

## 役割の付与

### 駆動
| 遷移 | 質問 ID |
|------|---------|
| P1→P2 | qXX |
| ... | ... |

### 蓄積
（同様の構造）

### 探索
（同様の構造）

### 分岐
（同様の構造）

## 検証

| 検証項目 | 結果 |
|---------|------|
| 各パラダイムの探索質問の充実 | ... |
| 各遷移の駆動質問の存在 | ... |
| 全体の量 | ... |
| 「いいえ」「関係ない」の質問 | ... |

## 全体構成

合計 **XX 問**

（役割別・正答別の分布表）
```

**POC 取り込みに必要な情報**: 各質問の ID・質問文・正答・対象記述素（→ questions の基礎情報）

---

## 05_形式化.md

02〜04 の分析結果を統合し、POC の JSON データに変換するために必要な構造化定義を行う。このステップは理論的分析の補完であり、POC 取り込みへの橋渡しとなる。

### テンプレート

```markdown
# 形式化：POC データ定義

入力:
- 記述素空間（02_記述素展開.md）
- パラダイム群（03_パラダイム発見.md）
- 質問群（04_質問生成.md）

## パラダイムの形式定義

### P1:（名称）

- d_plus（真と予測する記述素）: Fs-01, Fs-03, Fs-05, ...
- d_minus（偽と予測する記述素）: ...
- relations（同化辺）:
  - Fs-01 → Fs-03 (0.9)
  - Fs-05 → Fs-07 (0.9)
  - ...

（各パラダイムについて繰り返す）

### 形式定義の指針

d_plus/d_minus の選定基準:
- 鍵記述素を中心に、そのパラダイムの世界理解に整合する記述素を d_plus に含める
- そのパラダイムの世界理解と矛盾する記述素を d_minus に含める
- パラダイムが関知しない記述素は d_plus にも d_minus にも含めない

relations の定義基準:
- 同じパラダイム内で因果的・論理的に関連する記述素のペアを辺とする
- src が確定したとき tgt の確率が更新されるべき関係を選ぶ
- weight は関連の強さ（通常 0.9）

## 質問の ans 定義

### 既定パターン

対象記述素が単一（d）の質問:

| 回答 | 効果 |
|------|------|
| ans_yes | [(d, 1)] |
| ans_no | [(d, 0)] |
| ans_irrelevant | [d] |

対象記述素が「XX（否定）」の質問（正答がいいえ）:

| 回答 | 効果 |
|------|------|
| ans_yes | [(d, 1)] |
| ans_no | [(d, 0)] |
| ans_irrelevant | [d] |

### 既定パターンの例外

対象記述素が複数、または含意対応がある質問を個別に定義する。

| ID | ans_yes | ans_no | ans_irrelevant |
|----|---------|--------|----------------|
| qXX | [(d1, 1), (d2, 1)] | [(d1, 0)] | [d1] |
| ... | ... | ... | ... |

## クリア質問

クリア質問（回答によりゲームクリアとなる質問）を指定する。

| ID | 質問 | 根拠 |
|----|------|------|
| qXX | （質問文） | T の核心に到達する質問 |
```

---

## 運用上の注意

### アルゴリズムの選択

各ステップで使用するアルゴリズムは固定ではない。使用したアルゴリズムをファイル内に明記すること。

- 記述素展開: E1, E2, ...
- パラダイム発見: A（深度階層型）, ...
- 質問生成: Q1（パラダイム構造準拠型）, ...

### 反復と改善

04_質問生成 の検証で記述素空間の不足が見つかった場合、02 に戻って展開を改善する。この場合、改善点を 04 の E1 不足分析セクション等に記録し、将来の展開アルゴリズム改善の材料とする。

### POC データの生成

05_形式化.md の内容を app/poc/docs/data_import.md の変換手順に従って JSON に変換し、app/poc/data/ に配置する。
