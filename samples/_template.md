# サンプル運用ルール

## ディレクトリ命名

```
samples/NNN_YYYYMMDD_タイトル/
```

- NNN: 3 桁連番（001, 002, ...）
- YYYYMMDD: サンプル作成開始日
- タイトル: 問題の通称

## 反復ディレクトリ

```
samples/NNN_YYYYMMDD_タイトル/
  01_初回適用/
  02_○○適用/        ← 改善・再適用のたびに連番で追加
  03_○○適用/
```

- 反復のたびに新しい連番ディレクトリを作成する
- サブディレクトリ名は `NN_内容` の形式（例: `02_E2Q2適用`, `05_改善E1再適用`）

## ファイル命名

各反復ディレクトリ内のファイルは連番＋内容で命名する。

| ファイル名 | 内容 |
|---|---|
| 01_入力.md | Ps・Pt の定義 |
| 02_記述素展開.md | 記述素空間の生成結果 |
| 03_パラダイム発見.md | メインパス・サブパスの発見結果 |
| 04_内部構造分析.md | 各パラダイムの P_pred, Conceivable, R(P) |
| 05_質問生成.md | 質問群の生成結果 |
| 06_形式化.md | POC JSON データに変換可能な形式の整理 |
| 07_補充検証.md | 検証結果と補充内容 |

- 前段のファイルに変更がない場合は省略してよい
- 上記以外のファイルを追加してもよい（例: `質問生成_Q1.md`, `質問分類_Q3.md`）

## 06_形式化.md の要件

サンプルはデータインポートの元になるものであり、06_形式化.md は JSON への機械的変換が可能な完全データを含む。曖昧さや省略があってはならない。

### 必須セクション

#### 1. 前提事実（ps_values）

全 Ps 記述素の ID と値の完全リスト。

#### 2. 記述素 ID 一覧（all_descriptor_ids）

記述素空間に含まれる全記述素の ID リスト。

#### 3. パラダイム一覧（paradigms）

各パラダイム（メインパス・サブパラダイム全て）について以下を完全に記載する:

| 項目 | 内容 |
|------|------|
| id | パラダイム ID |
| name | パラダイム名 |
| p_pred | D⁺・D⁻ の完全リスト（論理的予測の全体） |
| conceivable | Conceivable(P) の完全リスト |
| relations | R(P) の完全リスト（横辺＋ゲート辺、[ソース, ターゲット, w]） |

「前パラダイムと大部分が重複」等の省略は不可。全パラダイムを完全に記載する。

#### 4. 質問一覧（questions）

全質問について以下を完全に記載する:

| 項目 | 内容 |
|------|------|
| id | 質問 ID |
| text | 質問テキスト |
| ans_yes | 「はい」の場合の効果 [[記述素ID, 値], ...] |
| ans_no | 「いいえ」の場合の効果 [[記述素ID, 値], ...] |
| ans_irrelevant | 「関係ない」の場合の効果 [記述素ID, ...] |
| correct_answer | 正答（"yes" / "no" / "irrelevant"） |
| is_clear | クリア質問か（true/false） |
| prerequisites | 前提記述素の ID リスト（なければ空リスト） |
| related_descriptors | 関連記述素の ID リスト |
| topic_category | トピックカテゴリ ID |

prerequisites は「類型 A が 6 問」のような集約ではなく、各質問に対する具体的な割り当てを記載する。

#### 5. トピックカテゴリ一覧（topic_categories）

カテゴリ ID と名称の対応表。

### 完全性の基準

06_形式化.md から JSON への変換は、内容の解釈や推測を一切必要としない機械的操作でなければならない。以下を満たすこと:

- 全パラダイムが省略なく記載されている
- 全質問が省略なく記載されている
- 各質問の prerequisites が個別に指定されている
- 前段のファイル（01〜05）を参照しなくても JSON が生成できる

## 運用上の注意

- 各ファイル内で使用したアルゴリズム名を明記する
- 06_形式化の内容を JSON に変換し `app/poc/data/` に配置する
- 07_補充検証は 06_形式化の後に実施し、JSON データ投入前に全検証を通過させる
