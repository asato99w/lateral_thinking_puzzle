# サンプル生成テンプレート

水平思考パズルに対して理論フレームワークを適用し、POC 取り込み可能なデータを生成するまでの流れ。

## ディレクトリ構成

```
samples/NNN_タイトル/
  01_初回適用/              ← 最初の適用
    01_入力.md
    02_記述素展開.md
    03_パラダイム発見.md
    04_内部構造分析.md
    05_質問生成.md
    06_形式化.md
    07_補充検証.md
  02_E2Q2適用/             ← E2/Q2 等を適用した改善版（必要に応じて）
    01_入力.md              ← 前回から変更がなければ省略可
    02_記述素展開.md
    ...
```

各サンプルは連番のサブディレクトリを持つ。サブディレクトリは適用の反復を表し、アルゴリズムの改善や再適用のたびに新しい連番ディレクトリを作成する。前段のファイルに変更がない場合は省略してよい。

## 各ファイルの内容

### 01_入力

quizzes/ の問題文を元に Ps（問題文の命題分解）と Pt（真相の命題分解）を定義する。

### 02_記述素展開

展開アルゴリズム（E1, E2 等）を Ps・Pt に適用し、記述素空間（Fs, Ft, D, 緊張関係）を生成する。

### 03_パラダイム発見

発見アルゴリズム（A 等）を記述素空間に適用し、メインパス（P1→...→PN=T）とサブパスを発見する。

### 04_内部構造分析

内部構造構成アルゴリズム（A 等）を各パラダイムに適用する。

- D⁺(P): P が真と予測する記述素
- D⁻(P): P が偽と予測する記述素
- R(P): 同化関係（ソース→ターゲット、重み）

アノマリーの単調減少条件（anomalies(O*, P1) > ... > anomalies(O*, PN) = 0）を検証する。

### 05_質問生成

質問生成アルゴリズム（Q1, Q2 等）を記述素空間とパラダイム群に適用し、質問群を生成する。各質問に役割（駆動・蓄積・探索・分岐・偶然の開き・クリア）を付与する。

### 06_形式化

02〜05 の分析結果を統合し、POC の JSON データに変換可能な形式に整理する。

- 追加記述素の定義（質問生成で不足した分）
- パラダイムの形式定義（04 の D⁺/D⁻/R(P) を JSON 形式に）
- 質問の ans 定義（ans_yes / ans_no / ans_irrelevant の効果）
- クリア質問の指定

### 07_補充検証

S1 アルゴリズムを適用し、anomaly 到達性と発掘連鎖到達性を検証・補充する。

#### 検証ステップ

1. **静的検証**: opening_reach.py を実行し、各パラダイムの anomaly 到達性を確認する
2. **動的検証**: anomaly_discovery.py を実行し、発掘連鎖到達性を確認する
   - Part 1（初期オープン汚染チェック）: anomaly 質問が初期オープンに含まれていないこと
   - Part 2（発掘連鎖シミュレーション）: 全 anomaly 質問が発掘可能であること

#### 不足時の対処

検証 NG の場合、S1 の不足類型に基づいて対処する:

- **類型 A〜C**（静的到達性の不足）: 固有記述素の追加、R(P) 接続強化、質問補強
- **類型 D**（発掘連鎖の断絶）: 質問の effect 修正（偶然の開きの構造化）、中間質問の追加、空間設計の見直し

#### 出力

- 検証結果の記録
- 追加・修正された記述素、R(P) 関係、質問
- 修正後の再検証結果

## 運用上の注意

- 各ステップで使用するアルゴリズムをファイル内に明記する
- 後段の検証で不足が見つかった場合、前段に戻って改善する
- 06_形式化の内容を JSON に変換し app/poc/data/ に配置する
- 07_補充検証は 06_形式化の後に必ず実施し、JSON データ投入前に全検証を通過させる
