# 質問生成 Step 4: フェーズ到達の検証

使用規則: 質問生成 → Q2 Step 7〜8（フェーズ到達保証）

## 1. flip 記述素の特定

各遷移 P_i → P_{i+1} について、P_pred が反転する記述素を特定する。

### P1 → P2

| 記述素 | P_pred(P1) | P_pred(P2) | flip 方向 |
|---|---|---|---|
| Fs-34 (善意禁止) | 1 | 0 | 1→0 |
| Fs-35 (秘密を守る) | 0 | 1 | 0→1 |
| Fs-87 (事後撤去) | 不定 | 1 | 不定→1 |
| Fs-89 (巧妙隠蔽) | 不定 | 1 | 不定→1 |

**flip(P1, P2) = {Fs-34, Fs-35}**（判定域内での反転のみ。不定→確定は flip の厳密な定義外だが、P2 で新たに確定する記述素として重要）

### P2 → P3

| 記述素 | P_pred(P2) | P_pred(P3) | flip 方向 |
|---|---|---|---|
| Fs-54 (異常光景) | 1 | 0 | 1→0 |
| Fs-60 (死体) | 1 | 0 | 1→0 |
| Fs-61 (犯罪証拠見た) | 1 | 0 | 1→0 |
| Fs-67 (犯罪目撃) | 1 | 0 | 1→0 |
| Fs-75 (犯罪現場通報) | 1 | 0 | 1→0 |
| Fs-87 (事後撤去) | 1 | 0 | 1→0 |
| Fs-88 (精神的問題) | 不定 | 1 | 不定→1 |
| Fs-86 (女性にとって異常) | 不定 | 1 | 不定→1 |
| Fs-100 (主観客観乖離) | 不定 | 1 | 不定→1 |
| Ft-20 (主観視点) | 0 | 1 | 0→1 |
| M-3 (普通のもの) | 不定 | 1 | 不定→1 |

**flip(P2, P3) = {Fs-54, Fs-60, Fs-61, Fs-67, Fs-75, Fs-87, Ft-20}**（判定域内反転）

### P3 → P4

| 記述素 | P_pred(P3) | P_pred(P4) | flip 方向 |
|---|---|---|---|
| Fs-88 (精神的問題) | 1 | 0 | 1→0 |
| M-4 (嘘の人物) | 0 | 1 | 0→1 |
| Ft-22 (虚偽世界観) | 0 | 1 | 0→1 |
| M-1 (外出不能) | 不定 | 1 | 不定→1 |

**flip(P3, P4) = {Fs-88, M-4, Ft-22}**

### P4 → P5(T)

| 記述素 | P_pred(P4) | P_pred(P5) | flip 方向 |
|---|---|---|---|
| Fs-51 (内部探索) | 1 | 0 | 1→0 |
| Pt-1 (監禁) | 不定 | 1 | 不定→1 |
| Pt-2 (ドア=出口) | 不定 | 1 | 不定→1 |
| Pt-3 (外の世界) | 不定 | 1 | 不定→1 |
| Pt-4 (外が普通) | 不定 | 1 | 不定→1 |
| Pt-5 (監禁通報) | 不定 | 1 | 不定→1 |

**flip(P4, P5) = {Fs-51}**（判定域内反転のみ。Pt 群は P4 で不定のため厳密な flip ではないが、P5 で確定する重要記述素）

## 2. フェーズ到達保証の検証

各遷移の flip 記述素を effect に含む質問の存在を確認する。

### P1 → P2

| flip 記述素 | 対応質問 | effect 内の値 | P2 の予測方向と一致 |
|---|---|---|---|
| Fs-34 | q-03 (ans_no) | Fs-34=0 | P2: Fs-34=0 ✓ |
| Fs-35 | q-14 (ans_yes) | Fs-35=1 | P2: Fs-35=1 ✓ |

**P1→P2 フェーズ到達: ✓**

### P2 → P3

| flip 記述素 | 対応質問 | effect 内の値 | P3 の予測方向と一致 |
|---|---|---|---|
| Fs-54 | q-01 (ans_no) | Fs-54=0 | P3: Fs-54=0 ✓ |
| Fs-60 | q-01 (ans_no) | Fs-60=0 | P3: Fs-60=0 ✓ |
| Fs-61 | q-01 (ans_no) | Fs-61=0 | P3: Fs-61=0 ✓ |
| Fs-67 | q-04 (ans_no) | Fs-67=0 | P3: Fs-67=0 ✓ |
| Fs-75 | q-04 (ans_no) | Fs-75=0 | P3: Fs-75=0 ✓ |
| Fs-87 | q-11 (ans_no) | Fs-87=0 | P3: Fs-87=0 ✓ |
| Ft-20 | q-19 (ans_yes) | Ft-20=1 | P3: Ft-20=1 ✓ |

**P2→P3 フェーズ到達: ✓**

### P3 → P4

| flip 記述素 | 対応質問 | effect 内の値 | P4 の予測方向と一致 |
|---|---|---|---|
| Fs-88 | q-18 (ans_no) | Fs-88=0 | P4: Fs-88=0 ✓ |
| M-4 | q-20 (ans_yes) | M-4=1 | P4: M-4=1 ✓ |
| Ft-22 | q-20 (ans_yes) | Ft-22=1 | P4: Ft-22=1 ✓ |

**P3→P4 フェーズ到達: ✓**

### P4 → P5(T)

| flip 記述素 | 対応質問 | effect 内の値 | P5 の予測方向と一致 |
|---|---|---|---|
| Fs-51 | q-27 (ans_yes) | Fs-51=0 | P5: Fs-51=0 ✓ |

追加（P4 で不定→P5 で確定の重要記述素）:

| 記述素 | 対応質問 | effect 内の値 |
|---|---|---|
| Pt-1 | q-23 (ans_yes) | Pt-1=1 ✓ |
| Pt-2 | q-24 (ans_yes) | Pt-2=1 ✓ |
| Pt-3 | q-28 (ans_yes) | Pt-3=1 ✓ |
| Pt-5 | q-29 (ans_yes) | Pt-5=1 ✓ |

**P4→P5 フェーズ到達: ✓**

## 3. 初期質問グループの flip 消費確認

初期質問グループ（prerequisites なしの q-01〜q-10）が flip 記述素を過剰にカバーしていないか確認する。

| 遷移 | flip 記述素 | 初期質問でカバー | シフト後に開く余地 |
|---|---|---|---|
| P1→P2 | Fs-34, Fs-35 | Fs-34 (q-03) | Fs-35 は q-14（層1）で供給。余地あり ✓ |
| P2→P3 | Fs-54等, Ft-20 | Fs-54 (q-01) | Ft-20 は q-19（層2）で供給。余地あり ✓ |
| P3→P4 | Fs-88, M-4, Ft-22 | なし | 全て層2質問。余地十分 ✓ |
| P4→P5 | Fs-51 | なし | q-27（層4）で供給。余地十分 ✓ |

**結果: 初期質問による flip 記述素の過剰消費なし。各シフト後に新たな質問がオープンする余地が確保されている。**

## 4. フェーズ到達保証まとめ

| 遷移 | flip 記述素数 | カバー率 | 状態 |
|---|---|---|---|
| P1→P2 | 2 | 100% | ✓ |
| P2→P3 | 7 | 100% | ✓ |
| P3→P4 | 3 | 100% | ✓ |
| P4→P5 | 1 (+4 Pt) | 100% | ✓ |

**Phase 3 完了。全遷移のフェーズ到達が保証されている。**

> **注記**: 同化接続性検証は適用保留中のためスキップ（統合アルゴリズムの指示に従う）。
