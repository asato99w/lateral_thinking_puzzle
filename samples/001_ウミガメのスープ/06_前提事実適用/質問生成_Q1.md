# 質問生成：前提事実の割り当て（Q1 Step 6 適用）

入力:
- 05_改善E1再適用/質問生成_Q1.md の質問群（q01〜q104）
- 05_改善E1再適用/07_補充検証.md の修正済み質問群
- 理論: theory/question/algorithms/Q1_パラダイム構造準拠型.md Step 6

---

## Step 6: 前提事実の割り当て

各質問について、その質問が論理的に成立するために確定済み（O に含まれていること）を要求する記述素を特定し、prerequisites として設定する。

判定基準: 「この記述素が確定していなければ、この質問を聞くこと自体が意味をなさない」という関係があるか。質問のテキスト中の前提節や定冠詞的用法が、特定の事実の確定を前提としているかどうかで判断する。

### 前提類型

分析の結果、以下の前提類型が特定された。

| 類型 | 前提記述素 | 内容 | 確定契機（代表的な質問） |
|------|-----------|------|------------------------|
| A | Fs-26 | 以前にスープを飲んだ | q20（以前にウミガメのスープを飲んだことがあるか） |
| B | Fs-27 | 誰かからスープを飲まされた | q21（「ウミガメのスープだ」と言われて飲まされた） |
| C | Ft-22 | 騙されていた | q33（誰かに騙されていたか） |
| D | Ft-37 | 以前のスープと味が違った | q31（以前飲んだスープと味は違ったか） |
| E | Pt-1 | 遭難した | q39（事故に遭ったか）/ q41（遭難したか） |
| F | Pt-3 | 誰かが死んだ | q47（そのとき誰かが死んだか） |
| G | Ft-02 | 仲間がいた | q43（そのとき仲間がいたか） |
| H | Ft-32 | 苦渋の決断をした | q53（仲間は苦渋の決断をしたか） |
| I | Fs-43 | 耐えられない事実を知った | q28（知った事実は耐えられないほどか） |

### 割り当て一覧

#### 類型 A: Fs-26（以前のスープ）を前提

「以前のスープ」「以前飲んだスープ」に定冠詞的に言及する質問。以前スープを飲んだ事実が確定していなければ質問が成立しない。

| ID | 質問テキスト | prerequisites |
|----|------------|---------------|
| q25 | 以前のスープは別の人が作りましたか？ | [Fs-26] |
| q31 | 以前飲んだスープと今回のスープの味は違いましたか？ | [Fs-26] |
| q32 | 以前飲んだスープは本物のウミガメのスープでしたか？ | [Fs-26] |
| q34 | 過去にスープを出した人物は男に本当のことを言っていましたか？ | [Fs-26] |
| q66 | 以前スープを飲んだときは、命に関わる状況でしたか？ | [Fs-26] |
| q93 | 以前のスープはレストランで飲みましたか？ | [Fs-26] |

#### 類型 B: Fs-27（スープを飲まされた）を前提

「スープを飲まされた」事実を前提とする質問。

Fs-27 の O 到達経路: P2 への遷移時、Fs-26（Step 32 で O 確定済み）→ Fs-27 の R(P2) 関係（w=0.8）により H[Fs-27] が同化で 0.9 に到達 → q21 がオープン → q21 回答で Fs-27 が O に入る。この経路は S1 Step 5b の構造的対処（R(P) への関係追加）により確保された。

| ID | 質問テキスト | prerequisites |
|----|------------|---------------|
| q101 | 過去にスープを飲まされたことは、人肉と関係がありますか？ | [Fs-27] |

#### 類型 C: Ft-22（騙されていた）を前提

「嘘をついた人物」「隠蔽」等、欺瞞の事実を前提とする質問。

| ID | 質問テキスト | prerequisites |
|----|------------|---------------|
| q35 | 嘘をついた人物に悪意はありましたか？ | [Ft-22] |
| q37 | 本当のことを言ったら男は飲みませんでしたか？ | [Ft-22] |
| q70 | 嘘をついた人物は男と一緒にいた仲間ですか？ | [Ft-22] |
| q71 | 男を助けようとして嘘をつかれたのは、船の上でのことですか？ | [Ft-22] |
| q74 | 隠蔽の結果、男は後に真実を悟りましたか？ | [Ft-22] |
| q104 | 騙されていたことと、仲間の存在は関係がありますか？ | [Ft-22] |

#### 類型 D: Ft-37（味が違った）を前提

味の違いが確定した上で、その原因を追究する質問。

| ID | 質問テキスト | prerequisites |
|----|------------|---------------|
| q69 | 以前のスープが別の食材だったことは、遭難と関係がありますか？ | [Ft-37] |

#### 類型 E: Pt-1（遭難）を前提

「そのとき」「遭難」「救助」等、遭難の事実を前提とする質問。

| ID | 質問テキスト | prerequisites |
|----|------------|---------------|
| q42 | 遭難しなければ今回の事態は起きませんでしたか？ | [Pt-1] |
| q43 | そのとき仲間がいましたか？ | [Pt-1] |
| q45 | 長い間救助が来ませんでしたか？ | [Pt-1] |
| q47 | そのとき誰かが死にましたか？ | [Pt-1] |

#### 類型 F: Pt-3（死者）を前提

「死んだのは」と、死の事実を前提とする質問。

| ID | 質問テキスト | prerequisites |
|----|------------|---------------|
| q48 | 死んだのは仲間ですか？ | [Pt-3] |

#### 類型 G: Ft-02（仲間）を前提

「仲間は」「仲間が」と、仲間の存在を前提とする質問。

| ID | 質問テキスト | prerequisites |
|----|------------|---------------|
| q49 | 仲間は飢えで死にましたか？ | [Ft-02] |
| q50 | 仲間が男にスープを飲ませましたか？ | [Ft-02] |
| q51 | 仲間は男を助けようとしましたか？ | [Ft-02] |
| q52 | 仲間は罪悪感を感じていましたか？ | [Ft-02] |
| q53 | 仲間は苦渋の決断をしましたか？ | [Ft-02] |
| q56 | 死んだ仲間の肉が使われましたか？ | [Pt-3, Ft-02] |
| q94 | 男が仲間を殺しましたか？ | [Ft-02] |

#### 類型 H: Ft-32（苦渋の決断）を前提

「苦渋の決断とは」と、決断の事実を前提とする質問。

| ID | 質問テキスト | prerequisites |
|----|------------|---------------|
| q73 | 苦渋の決断とは、死んだ仲間の肉をスープにすることですか？ | [Ft-32] |

#### 類型 I: Fs-43（耐えられない事実）を前提

「耐えられない事実は」と、事実の衝撃を前提とする質問。

| ID | 質問テキスト | prerequisites |
|----|------------|---------------|
| q103 | 耐えられない事実は、遭難事故と関係がありますか？ | [Fs-43] |

### prerequisites なしの質問

残りの 76 問は prerequisites を空（[]）とする。これらは以下のいずれかに該当する:

- 問題文の情報のみで成立する基本的な質問（q01〜q04, q07〜q14 等）
- 探索的・仮説的な質問（「〜ですか？」と事実の存否を問う質問）
- 否定代替仮説・5W1H 系の質問（q75〜q92）
- 上位概念化・架け橋質問で前提なしで成立するもの（q95〜q100, q102）

---

## 統計

| 項目 | 値 |
|------|-----|
| 全質問数 | 104 |
| prerequisites 付き質問数 | 28 (26.9%) |
| 使用前提記述素の種類数 | 9 |
| 最大 prerequisites 数（1質問あたり） | 2（q56: [Pt-3, Ft-02]） |

### 前提記述素の使用頻度

| 前提記述素 | 使用回数 | 該当質問数 |
|-----------|---------|-----------|
| Ft-02（仲間） | 8 | q49, q50, q51, q52, q53, q56, q94 + q56 |
| Fs-26（以前のスープ） | 6 | q25, q31, q32, q34, q66, q93 |
| Ft-22（騙された） | 6 | q35, q37, q70, q71, q74, q104 |
| Pt-1（遭難） | 4 | q42, q43, q45, q47 |
| Pt-3（死者） | 2 | q48, q56 |
| Fs-27, Fs-43, Ft-32, Ft-37 | 各 1 | 各 1 質問 |

---

## 検証

### 前提事実の到達可能性

各 prerequisites の記述素がゲーム進行で O に入りうることを確認する。

| 前提記述素 | 確定経路 | 到達可能性 |
|-----------|---------|-----------|
| Fs-26 | q20 回答（はい）→ O[Fs-26]=1 / q63 回答（はい）→ O[Fs-26]=1 | ✓ |
| Fs-27 | q21 回答（はい）→ O[Fs-27]=1 | ✓（※） |
| Fs-43 | q28 回答（はい）→ O[Fs-43]=1 | ✓ |
| Ft-02 | q43 回答（はい）→ O[Ft-02]=1 | ✓ |
| Ft-22 | q33 回答（はい）→ O[Ft-22]=1 | ✓ |
| Ft-32 | q53 回答（はい）→ O[Ft-32]=1 | ✓ |
| Ft-37 | q31 回答（はい）→ O[Ft-37]=1 | ✓ |
| Pt-1 | q39/q41 回答（はい）→ O[Pt-1]=1 | ✓ |
| Pt-3 | q47 回答（はい）→ O[Pt-3]=1 | ✓ |

全前提記述素が到達可能。✓

### 前提事実の連鎖確認

prerequisites が連鎖的に依存する場合（A の前提が B で、B 自身も前提付き）の確認。

| 質問 | prerequisites | 前提記述素の確定質問 | その質問の prerequisites |
|------|-------------|-------------------|----------------------|
| q48 | [Pt-3] | q47 | [Pt-1] |
| q49 | [Ft-02] | q43 | [Pt-1] |
| q56 | [Pt-3, Ft-02] | q47, q43 | [Pt-1], [Pt-1] |
| q69 | [Ft-37] | q31 | [Fs-26] |
| q73 | [Ft-32] | q53 | [Ft-02] |
| q101 | [Fs-27] | q21 | [] |
| q103 | [Fs-43] | q28 | [] |

連鎖は全て到達可能な経路を持つ。✓

### Fs-27 の動的到達性（S1 Step 5b 構造的対処）

Fs-27 の静的到達可能性は q21（prerequisites なし）により確保されている。しかし q21 の effect は (Fs-27, 1) のみであり、q21 がオープンするには H[Fs-27] ≈ 1 が必要。Fs-27 は P1 の D(P) に含まれず H[Fs-27] の初期値は 0.5 であるため、同化経路なしでは q21 がオープンしない。

S1 Step 5b の構造的対処として、P2 の R(P) に Fs-26 → Fs-27（w=0.8）関係を追加した。これにより：

1. Step 32: q63 回答 → Fs-26 が O に入る
2. Step 33: q65 回答 → P1→P2 シフト → Fs-26 ∈ O と Fs-26→Fs-27 関係により同化発火 → H[Fs-27]: 0.500 → 0.900 → q21 がオープン
3. Step 42: q21 回答 → Fs-27 が O に入る → q101 の prerequisites 充足 → q101 がオープン

（※）上記により Fs-27 の動的到達性が確保される。

### 初期オープン質問への影響

init_questions(P1) で開く質問のうち、prerequisites 付きの質問はないことを確認する。

初期オープン質問は P1 の D⁺ 記述素のみを effect に含む safe 質問であり、いずれも prerequisites = [] である。prerequisites の追加により初期オープン質問が減少することはない。✓
