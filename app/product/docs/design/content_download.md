# ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰è¨­è¨ˆ

## æ¦‚è¦

ãƒ‘ã‚ºãƒ«ãƒ‡ãƒ¼ã‚¿ã®ä¸€éƒ¨ã‚’ã‚¢ãƒ—ãƒªã«åŒæ¢±ã—ã€è¿½åŠ ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯DLCï¼ˆãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ï¼‰ã¨ã—ã¦ODRï¼ˆOn-Demand Resourcesï¼‰çµŒç”±ã§App Storeã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰æä¾›ã™ã‚‹ã€‚
ç„¡æ–™ã®è¿½åŠ ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚‚DLCã¨ã—ã¦é…ä¿¡ã™ã‚‹ã€‚

### æŠ€è¡“é¸å®šã®èƒŒæ™¯

| æŠ€è¡“ | è¦ä»¶ | æœ¬ã‚¢ãƒ—ãƒª | æ¡ç”¨ |
|------|------|---------|------|
| ODR (On-Demand Resources) | iOS 9+ | iOS 17+ âœ… | âœ… ç¾è¡Œæ¡ç”¨ |
| AHBA (Apple-Hosted Background Assets) | iOS 26+ | iOS 17+ âŒ | âŒ å°†æ¥ç§»è¡Œ |
| è‡ªå‰ã‚µãƒ¼ãƒé…ä¿¡ | ã‚µãƒ¼ãƒé‹ç”¨ | ä¸è¦æ–¹é‡ | âŒ |

WWDC 2025ã§Appleã¯ODRã®æ–°è¦æ¡ç”¨ã‚’éæ¨å¥¨ã¨ã—ã€Background Assetsãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ï¼ˆAHBAï¼‰ã‚’å¾Œç¶™ã¨ã—ã¦æ¨å¥¨ã—ãŸã€‚
ã—ã‹ã—AHBAã¯iOS 26+ãŒå¿…è¦ã§ã‚ã‚Šã€æœ¬ã‚¢ãƒ—ãƒªã®ãƒ‡ãƒ—ãƒ­ã‚¤ã‚¿ãƒ¼ã‚²ãƒƒãƒˆï¼ˆiOS 17.0+ï¼‰ã§ã¯AHBAã‚’åˆ©ç”¨ã§ããªã„ã€‚

**æ–¹é‡**: ODRã§å®Ÿè£…ã—ã€å°†æ¥iOS 26+ã«ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚’å¼•ãä¸Šã’ãŸæ™‚ç‚¹ã§AHBAã«ç§»è¡Œã™ã‚‹ã€‚
ç§»è¡Œã‚³ã‚¹ãƒˆã‚’æœ€å°åŒ–ã™ã‚‹ãŸã‚ã€ãƒªã‚½ãƒ¼ã‚¹å–å¾—å±¤ã‚’ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã§æŠ½è±¡åŒ–ã™ã‚‹ã€‚

## åŸºæœ¬æ–¹é‡

- åˆæœŸãƒ‘ã‚ºãƒ«ã¯ã‚¢ãƒ—ãƒªã«åŒæ¢±ï¼ˆã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã§å³ãƒ—ãƒ¬ã‚¤å¯èƒ½ï¼‰
- è¿½åŠ ãƒ‘ã‚ºãƒ«ã¯DLCã¨ã—ã¦é…ä¿¡ï¼ˆç„¡æ–™å«ã‚€ï¼‰
- ãƒ‘ãƒƒã‚¯å˜ä½ã§ã‚‚å€‹åˆ¥ã§ã‚‚ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å¯èƒ½
- ãƒ‘ãƒƒã‚¯æ§‹æˆã¯æŸ”è»Ÿã«çµ„ã¿æ›¿ãˆå¯èƒ½
- è‡ªå‰ã‚µãƒ¼ãƒã¯ä¸è¦ï¼ˆApple ODR + ã‚¢ãƒ—ãƒªåŒæ¢±ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ï¼‰

## ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### ã‚¢ãƒ—ãƒªæœ¬ä½“ã«åŒæ¢±ã™ã‚‹ã‚‚ã®

| ç¨®é¡ | å†…å®¹ | ä¾‹ |
|------|------|-----|
| ã‚¨ãƒ³ã‚¸ãƒ³ | ã‚²ãƒ¼ãƒ ãƒ­ã‚¸ãƒƒã‚¯ãƒ»è³ªå•å±•é–‹ãƒ»ã‚¯ãƒªã‚¢åˆ¤å®š | Engine/, UseCases/ |
| UI | å…¨ç”»é¢ã®SwiftUIãƒ“ãƒ¥ãƒ¼ | Presentation/ |
| ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ | ãƒ‘ã‚ºãƒ«ãƒ»ãƒ‘ãƒƒã‚¯å®šç¾©ã€è¡¨ç¤ºæƒ…å ± | catalog.json |
| åˆæœŸãƒ‘ã‚ºãƒ« | ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã§å³ãƒ—ãƒ¬ã‚¤å¯èƒ½ãªãƒ‘ã‚ºãƒ«ç¾¤ | Resources/Puzzles/ |

### ODRã§é…ä¿¡ã™ã‚‹ã‚‚ã®

| ç¨®é¡ | å†…å®¹ | å˜ä½ |
|------|------|------|
| ãƒ‘ã‚ºãƒ«ãƒ‡ãƒ¼ã‚¿ | ã‚²ãƒ¼ãƒ é€²è¡Œã«å¿…è¦ãªJSONï¼ˆè³ªå•ãƒ»å›ç­”ãƒ»æ§‹é€ ï¼‰ | ãƒ‘ã‚ºãƒ«1å• = 1ã‚¿ã‚° |

## ODRã‚¿ã‚°è¨­è¨ˆ

### ã‚¿ã‚°ç²’åº¦

**1ãƒ‘ã‚ºãƒ« = 1ã‚¿ã‚°**ï¼ˆãƒ‘ãƒƒã‚¯å˜ä½ã®ã‚¿ã‚°ã¯è¨­ã‘ãªã„ï¼‰

```
puzzle-bar-man        â†’ ãƒãƒ¼ã®ç”·ã®ã‚²ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿JSON
puzzle-desert-man     â†’ ç ‚æ¼ ã®ç”·ã®ã‚²ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿JSON
puzzle-turtle-soup    â†’ ã‚¦ãƒŸã‚¬ãƒ¡ã®ã‚¹ãƒ¼ãƒ—ã®ã‚²ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿JSON
...
```

### ã‚¿ã‚°ã‚«ãƒ†ã‚´ãƒªã®æŒ¯ã‚Šåˆ†ã‘

| ã‚«ãƒ†ã‚´ãƒª | ç”¨é€” | å¯¾è±¡ |
|---------|------|------|
| Initial Install | ãªã—ï¼ˆåŒæ¢±ãƒ‘ã‚ºãƒ«ã¯ãƒãƒ³ãƒ‰ãƒ«ã«ç›´æ¥å«ã‚€ï¼‰ | - |
| Prefetch | ãªã— | - |
| On-Demand | è¿½åŠ ãƒ‘ã‚ºãƒ« | åŒæ¢±å¤–ã®å…¨ãƒ‘ã‚ºãƒ«ã‚¿ã‚° |

### ãƒ‘ãƒƒã‚¯ã¯ODRã‚¿ã‚°ã§ã¯ãªããƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã§ç®¡ç†

ãƒ‘ãƒƒã‚¯æ§‹æˆã‚’ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã§å®šç¾©ã™ã‚‹ã“ã¨ã§ã€ã‚¢ãƒ—ãƒªæ›´æ–°ã®ã¿ã§ãƒ‘ãƒƒã‚¯ã®çµ„ã¿æ›¿ãˆãŒå¯èƒ½ã€‚

```
ãƒ‘ãƒƒã‚¯ã€Œå®šç•ªã€: [puzzle-bar-man, puzzle-desert-man, puzzle-turtle-soup]
ãƒ‘ãƒƒã‚¯ã€Œä¸Šç´šã€: [puzzle-desert-man, puzzle-underground, puzzle-cassette]
```

- 1ã¤ã®ãƒ‘ã‚ºãƒ«ãŒè¤‡æ•°ãƒ‘ãƒƒã‚¯ã«å±ã›ã‚‹
- ãƒ‘ãƒƒã‚¯DL = æ‰€å±ãƒ‘ã‚ºãƒ«ã®ã‚¿ã‚°ã‚’ä¸€æ‹¬ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
- å€‹åˆ¥DL = ãã®ãƒ‘ã‚ºãƒ«ã®ã‚¿ã‚°ã ã‘ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
- æ—¢ã«DLæ¸ˆã¿ã®ãƒ‘ã‚ºãƒ«ã¯å†DLã•ã‚Œãªã„ï¼ˆOSãŒç®¡ç†ï¼‰

## ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿è¨­è¨ˆ

### ã‚«ã‚¿ãƒ­ã‚°æ§‹é€ 

ã‚¢ãƒ—ãƒªã«åŒæ¢±ã™ã‚‹ `catalog.json` ã§ãƒ‘ã‚ºãƒ«ã¨ãƒ‘ãƒƒã‚¯ã‚’å®šç¾©ã™ã‚‹ã€‚

```json
{
  "puzzles": [
    {
      "id": "bar-man",
      "odrTag": "puzzle-bar-man",
      "title": "ãƒãƒ¼ã®ç”·",
      "statementPreview": "ã‚ã‚‹ç”·ãŒãƒãƒ¼ã«å…¥ã‚Š...",
      "icon": "ğŸ¸",
      "difficulty": 2,
      "tier": "free"
    },
    {
      "id": "desert-man",
      "odrTag": "puzzle-desert-man",
      "title": "ç ‚æ¼ ã®ç”·",
      "statementPreview": "ç ‚æ¼ ã®çœŸã‚“ä¸­ã§...",
      "icon": "ğŸœï¸",
      "difficulty": 3,
      "tier": "free"
    }
  ],
  "packs": [
    {
      "id": "classic",
      "title": "å®šç•ªãƒ‘ãƒƒã‚¯",
      "description": "äººæ°—ã®æ°´å¹³æ€è€ƒãƒ‘ã‚ºãƒ«10å•",
      "icon": "ğŸ“¦",
      "puzzleIDs": ["bar-man", "desert-man", "turtle-soup"],
      "tier": "free"
    },
    {
      "id": "advanced",
      "title": "ä¸Šç´šãƒ‘ãƒƒã‚¯",
      "description": "é›£æ˜“åº¦é«˜ã‚ã®5å•",
      "icon": "ğŸ”¥",
      "puzzleIDs": ["desert-man", "underground", "cassette"],
      "tier": "paid"
    }
  ]
}
```

### ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã®å±æ€§

#### ãƒ‘ã‚ºãƒ«

| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ | å‹ | èª¬æ˜ |
|-----------|-----|------|
| id | String | ãƒ‘ã‚ºãƒ«è­˜åˆ¥å­ |
| odrTag | String | ODRã‚¿ã‚°å |
| title | String | è¡¨ç¤ºã‚¿ã‚¤ãƒˆãƒ« |
| statementPreview | String | å‡ºé¡Œæ–‡ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ |
| icon | String | çµµæ–‡å­— |
| difficulty | Int | é›£æ˜“åº¦ï¼ˆ1-3ï¼‰ |
| tier | String | "free" or "paid" |

#### ãƒ‘ãƒƒã‚¯

| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ | å‹ | èª¬æ˜ |
|-----------|-----|------|
| id | String | ãƒ‘ãƒƒã‚¯è­˜åˆ¥å­ |
| title | String | ãƒ‘ãƒƒã‚¯å |
| description | String | ãƒ‘ãƒƒã‚¯èª¬æ˜ |
| icon | String | çµµæ–‡å­— |
| puzzleIDs | [String] | æ‰€å±ãƒ‘ã‚ºãƒ«IDãƒªã‚¹ãƒˆ |
| tier | String | "free" or "paid" |

## ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰çŠ¶æ…‹ç®¡ç†

### ãƒ‘ã‚ºãƒ«å˜ä½ã®çŠ¶æ…‹

| çŠ¶æ…‹ | æ¡ä»¶ |
|------|------|
| notDownloaded | ODRã‚¿ã‚°ãŒæœªå–å¾— |
| downloading(progress) | DLä¸­ï¼ˆ0.0ã€œ1.0ï¼‰ |
| downloaded | ODRã‚¿ã‚°å–å¾—æ¸ˆã¿ |

### ãƒ‘ãƒƒã‚¯å˜ä½ã®çŠ¶æ…‹ï¼ˆãƒ‘ã‚ºãƒ«çŠ¶æ…‹ã‹ã‚‰å°å‡ºï¼‰

| çŠ¶æ…‹ | æ¡ä»¶ |
|------|------|
| notDownloaded | æ‰€å±ãƒ‘ã‚ºãƒ«ãŒå…¨ã¦æœªDL |
| partial(downloaded, total) | ä¸€éƒ¨DLæ¸ˆã¿ |
| downloading(progress) | DLå‡¦ç†ä¸­ |
| downloaded | æ‰€å±ãƒ‘ã‚ºãƒ«ãŒå…¨ã¦DLæ¸ˆã¿ |

## ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ç”»é¢

### ç”»é¢æ§‹æˆ

```
ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ç”»é¢
â”œâ”€â”€ ãƒ‘ãƒƒã‚¯ã‚»ã‚¯ã‚·ãƒ§ãƒ³
â”‚   â”œâ”€â”€ ãƒ‘ãƒƒã‚¯ã‚«ãƒ¼ãƒ‰ï¼ˆãƒ‘ãƒƒã‚¯åãƒ»èª¬æ˜ãƒ»ãƒ‘ã‚ºãƒ«æ•°ãƒ»DLçŠ¶æ…‹ï¼‰
â”‚   â”œâ”€â”€ ãƒ‘ãƒƒã‚¯ã‚«ãƒ¼ãƒ‰
â”‚   â””â”€â”€ ...
â””â”€â”€ å€‹åˆ¥ãƒ‘ã‚ºãƒ«ã‚»ã‚¯ã‚·ãƒ§ãƒ³
    â”œâ”€â”€ ãƒ‘ã‚ºãƒ«ã‚«ãƒ¼ãƒ‰ï¼ˆã‚¿ã‚¤ãƒˆãƒ«ãƒ»çµµæ–‡å­—ãƒ»é›£æ˜“åº¦ãƒ»DLçŠ¶æ…‹ï¼‰
    â”œâ”€â”€ ãƒ‘ã‚ºãƒ«ã‚«ãƒ¼ãƒ‰
    â””â”€â”€ ...
```

### ãƒ‘ãƒƒã‚¯ã‚«ãƒ¼ãƒ‰ã®è¡¨ç¤º

- ãƒ‘ãƒƒã‚¯åãƒ»èª¬æ˜
- æ‰€å±ãƒ‘ã‚ºãƒ«æ•°ã¨DLæ¸ˆã¿æ•°ï¼ˆä¾‹ï¼šã€Œ3 / 5 ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰æ¸ˆã¿ã€ï¼‰
- ãƒ‘ãƒƒã‚¯å†…ãƒ‘ã‚ºãƒ«ã®çµµæ–‡å­—ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼
- DLãƒœã‚¿ãƒ³ or é€²æ—ãƒãƒ¼ or ãƒã‚§ãƒƒã‚¯ãƒãƒ¼ã‚¯
- ç„¡æ–™/æœ‰æ–™ãƒãƒƒã‚¸ï¼ˆå°†æ¥ï¼‰

### å€‹åˆ¥ãƒ‘ã‚ºãƒ«ã‚«ãƒ¼ãƒ‰ã®è¡¨ç¤º

- çµµæ–‡å­—ãƒ»ã‚¿ã‚¤ãƒˆãƒ«ãƒ»é›£æ˜“åº¦
- DLãƒœã‚¿ãƒ³ or é€²æ—ãƒãƒ¼ or ãƒã‚§ãƒƒã‚¯ãƒãƒ¼ã‚¯
- æ‰€å±ãƒ‘ãƒƒã‚¯è¡¨ç¤ºï¼ˆä»»æ„ï¼‰

### ç”»é¢ã¸ã®å°ç·š

ãƒ‘ã‚ºãƒ«ä¸€è¦§ç”»é¢ã«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒœã‚¿ãƒ³ã‚’é…ç½®ã—ã€ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ç”»é¢ã¸é·ç§»ã€‚

## ODRæ“ä½œãƒ•ãƒ­ãƒ¼

### å€‹åˆ¥ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰

```
1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ‘ã‚ºãƒ«ã®DLãƒœã‚¿ãƒ³ã‚’ã‚¿ãƒƒãƒ—
2. NSBundleResourceRequest(tags: [odrTag]) ã‚’ç”Ÿæˆ
3. conditionallyBeginAccessingResources() ã§ç¢ºèª
4. æœªDLãªã‚‰ beginAccessingResources() ã§DLé–‹å§‹
5. progress ã‚’ç›£è¦–ã—ã¦UIã«é€²æ—è¡¨ç¤º
6. å®Œäº†å¾Œã€Preservation Priority ã‚’è¨­å®š
```

### ãƒ‘ãƒƒã‚¯ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰

```
1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ‘ãƒƒã‚¯ã®DLãƒœã‚¿ãƒ³ã‚’ã‚¿ãƒƒãƒ—
2. ãƒ‘ãƒƒã‚¯å†…ã®æœªDLãƒ‘ã‚ºãƒ«ã®ã‚¿ã‚°ã‚’åé›†
3. å„ã‚¿ã‚°ã«å¯¾ã—ã¦å€‹åˆ¥DLãƒ•ãƒ­ãƒ¼ã‚’ä¸¦åˆ—å®Ÿè¡Œ
4. å…¨ä½“ã®é€²æ—ã‚’ã¾ã¨ã‚ã¦UIã«è¡¨ç¤º
5. å®Œäº†å¾Œã€å„ã‚¿ã‚°ã® Preservation Priority ã‚’è¨­å®š
```

### Preservation Priority æ–¹é‡

| çŠ¶æ…‹ | Priority | ç†ç”± |
|------|----------|------|
| DLæ¸ˆã¿ï¼ˆæœ‰æ–™ï¼‰ | 1.0 | èª²é‡‘æ¸ˆã¿ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’æœ€å„ªå…ˆä¿æŒ |
| DLæ¸ˆã¿ï¼ˆç„¡æ–™ï¼‰ | 0.5 | å†DLå¯èƒ½ã ãŒåˆ©ä¾¿æ€§ã®ãŸã‚ä¿æŒ |
| æœªä½¿ç”¨ | 0.0 | OSã«ã‚ˆã‚‹ãƒ‘ãƒ¼ã‚¸ã‚’è¨±å¯ |

## ãƒ‘ã‚ºãƒ«ä¸€è¦§ç”»é¢ã¨ã®é€£æº

### æœªDLãƒ‘ã‚ºãƒ«ã®æ‰±ã„

ãƒ‘ã‚ºãƒ«ä¸€è¦§ç”»é¢ã§ã¯ã€æœªDLãƒ‘ã‚ºãƒ«ã‚‚ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã«åŸºã¥ã„ã¦ã‚«ãƒ¼ãƒ‰ã‚’è¡¨ç¤ºã™ã‚‹ã€‚

| çŠ¶æ…‹ | è¡¨ç¤º | ã‚¿ãƒƒãƒ—æ™‚ |
|------|------|---------|
| DLæ¸ˆã¿ | é€šå¸¸ã®ã‚«ãƒ¼ãƒ‰ | ã‚²ãƒ¼ãƒ ç”»é¢ã¸é·ç§» |
| æœªDL | ã‚«ãƒ¼ãƒ‰ + DLã‚¢ã‚¤ã‚³ãƒ³ | DLé–‹å§‹ â†’ å®Œäº†å¾Œã«ã‚²ãƒ¼ãƒ ç”»é¢ã¸ |
| DLä¸­ | ã‚«ãƒ¼ãƒ‰ + é€²æ—è¡¨ç¤º | æ“ä½œä¸å¯ |

## ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã®å°†æ¥æ‹¡å¼µ

### Phase 1ï¼ˆåˆæœŸãƒªãƒªãƒ¼ã‚¹ï¼‰

- ã‚¢ãƒ—ãƒªåŒæ¢± `catalog.json`
- ãƒ‘ãƒƒã‚¯æ§‹æˆå¤‰æ›´ã«ã¯ã‚¢ãƒ—ãƒªæ›´æ–°ãŒå¿…è¦

### Phase 2ï¼ˆå°†æ¥ï¼‰

- ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿è‡ªä½“ã‚’ODRã§é…ä¿¡ï¼ˆã‚¢ãƒ—ãƒªæ›´æ–°ãªã—ã§ãƒ‘ãƒƒã‚¯æ§‹æˆå¤‰æ›´å¯èƒ½ã€ãŸã ã—Appå¯©æŸ»ã¯å¿…è¦ï¼‰
- ã¾ãŸã¯å¤–éƒ¨APIã§ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿é…ä¿¡ï¼ˆå®Œå…¨ãªè‡ªç”±åº¦ã€ã‚µãƒ¼ãƒå¿…è¦ï¼‰

### Phase 3ï¼ˆèª²é‡‘å°å…¥å¾Œï¼‰

- StoreKit 2 ã§ãƒ‘ãƒƒã‚¯/å€‹åˆ¥ã®è³¼å…¥ãƒ•ãƒ­ãƒ¼è¿½åŠ 
- `tier: "paid"` ã®ãƒ‘ã‚ºãƒ«/ãƒ‘ãƒƒã‚¯ã¯è³¼å…¥å¾Œã«DLå¯èƒ½
- ãƒ¬ã‚·ãƒ¼ãƒˆæ¤œè¨¼ã§ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡

## æ³¨æ„äº‹é …

### ODRã®åˆ¶ç´„

- 1ã‚¿ã‚°ã‚ãŸã‚Šæ¨å¥¨64MBä»¥ä¸‹ï¼ˆãƒ‘ã‚ºãƒ«JSONã¯ååˆ†å°ã•ã„ï¼‰
- ã‚¢ãƒ—ãƒªå…¨ä½“ã®ODRåˆè¨ˆ20GBä¸Šé™
- ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã§åŒæ™‚ä½¿ç”¨ä¸­ã®ODR 2GBä¸Šé™
- ã‚¢ã‚»ãƒƒãƒˆãƒ‘ãƒƒã‚¯æ•°ä¸Šé™ 1,000å€‹/ã‚¢ãƒ—ãƒª
- OSãŒã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ä¸è¶³æ™‚ã«ãƒ‘ãƒ¼ã‚¸ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹

### ODRã®å°†æ¥æ€§ã¨AHBAç§»è¡Œè¨ˆç”»

WWDC 2025ã§AppleãŒODRã®æ–°è¦æ¡ç”¨ã‚’éæ¨å¥¨ã¨ã—ã€Apple-Hosted Background Assetsï¼ˆAHBAï¼‰ã‚’å¾Œç¶™ã¨ã—ã¦æ¨å¥¨ã€‚
AHBAã¯iOS 26+ãŒå¿…è¦ã§ã‚ã‚Šã€æœ¬ã‚¢ãƒ—ãƒªã®iOS 17+ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã§ã¯ç¾æ™‚ç‚¹ã§åˆ©ç”¨ä¸å¯ã€‚

#### ç§»è¡Œæ¡ä»¶

| æ¡ä»¶ | ç¾çŠ¶ | ç§»è¡Œãƒˆãƒªã‚¬ãƒ¼ |
|------|------|-------------|
| ãƒ‡ãƒ—ãƒ­ã‚¤ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ | iOS 17+ | iOS 26+ã«å¼•ãä¸Šã’æ™‚ |
| ODRéæ¨å¥¨åº¦ | soft deprecation | AppleãŒå®Œå…¨å»ƒæ­¢ã‚’å®£è¨€ã—ãŸå ´åˆ |
| ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ™ãƒ¼ã‚¹ | - | iOS 26+ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒååˆ†ãªå‰²åˆã«é”ã—ãŸæ™‚ |

#### ç§»è¡Œã‚’å®¹æ˜“ã«ã™ã‚‹è¨­è¨ˆ

ãƒªã‚½ãƒ¼ã‚¹å–å¾—å±¤ã‚’ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã§æŠ½è±¡åŒ–ã—ã€ODR/AHBAåˆ‡ã‚Šæ›¿ãˆã‚’DIï¼ˆä¾å­˜æ€§æ³¨å…¥ï¼‰ã§å®Ÿç¾ã™ã‚‹ã€‚

```swift
/// ãƒªã‚½ãƒ¼ã‚¹å–å¾—ã®æŠ½è±¡åŒ–
protocol ResourceProvider {
    func isAvailable(tag: String) async -> Bool
    func download(tag: String, progress: @escaping (Double) -> Void) async throws
    func setPreservationPriority(_ priority: Double, for tag: String)
}

/// ç¾è¡Œ: ODRå®Ÿè£…
final class ODRResourceProvider: ResourceProvider { ... }

/// å°†æ¥: AHBAå®Ÿè£…ï¼ˆiOS 26+ï¼‰
// final class AHBAResourceProvider: ResourceProvider { ... }
```

**ç§»è¡Œæ™‚ã®å¤‰æ›´ç¯„å›²**:
- `AHBAResourceProvider` ã®æ–°è¦å®Ÿè£…
- DIè¨­å®šã®åˆ‡ã‚Šæ›¿ãˆï¼ˆ1ç®‡æ‰€ï¼‰
- UIå±¤ãƒ»ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯å±¤ã¯å¤‰æ›´ä¸è¦
