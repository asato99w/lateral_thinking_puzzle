# オープン条件の再構成

## 背景

同化の現行の意義はパラダイム内での横方向のアノマリー探索に限られるが、アノマリー質問のオープンは「偶然による開き」（H 値がたまたま正解値に近い）に限定されている。認知的観点から見直す。

## 現行のオープン条件

```
質問 q がオープンする条件:
  1. P_current ∈ q.paradigms
  2. ∀d ∈ prerequisites(q): d ∈ O
  3. ∃(d, v) ∈ effect(q): |H[d] - v| < EPSILON
```

条件3の実質: 同化は H を P_pred の方向にしか動かさない。ゆえに H[d] ≈ v が成立するのは P_pred(P, d) == v の場合に限られる。つまり「パラダイムの予測が真値と一致する記述素」を通じてのみ質問がオープンする。

アノマリー質問も、effect 内の P_pred と一致する側の記述素を通じてオープンし、回答後に不一致側がアノマリーとして O に入る。

## 問題

- 条件3は「H が正解値に近い」= プレイヤーがほぼ答えを知っている質問だけ思いつく、と言っている
- パラダイムの予測と矛盾する方向の探索が原理的に表現できない
- 実際のプレイヤーはアノマリー（違和感）に気づくと、その周辺を積極的に掘る

## 新しいオープン条件

H のオープン条件からの参照を外し、O と R(P) によるグラフ到達性に置き換える。H 自体はシステムに残す（alignment 等の診断指標）。

```
質問 q がオープンする条件:
  1. P_current ∈ q.paradigms
  2. ∀d ∈ prerequisites(q): d ∈ O
  3. 以下のいずれか:
     a) 一致からの探索:
        ∃(d, v) ∈ effect(q):
          d が Consistent(O, P) から R(P) 経由で到達可能
          かつ P_pred(P, d) = v
        ただし Consistent(O, P) = {o ∈ O : P_pred(P, o) = O[o]}
     b) 違和感からの探索:
        ∃(d, v) ∈ effect(q):
          d が Anomaly(O, P) から R(P) 経由で到達可能
```

### 一致からの探索（3a）

現行の H 値条件を明示化したもの。パラダイムと一致する O の記述素から R(P) を辿り、到達先でもパラダイムの予測が正解と一致する記述素を通じてオープンする。

認知的な動機: パラダイムに沿った体系的な探索。

### 違和感からの探索（3b）

新規追加。アノマリー記述素から R(P) を辿り、到達先の P_pred 一致は問わない。

認知的な動機: 「何かおかしい」から出発した探索は、パラダイムの予測を信じていない。到達先について正しいか間違っているかの事前判断なしに質問が発想される。

## 影響

- **H**: オープン条件から外れる。同化メカニズムは H を更新し続けるが、質問オープンには使わない
- **同化の役割変化**: 「H を動かして質問をオープンさせる」→ 「R(P) はオープン条件の到達性グラフとして参照される」
- **段階性**: H の連続的な伝播による段階的オープンは失われる。段階性は prerequisites のみで制御される。必要に応じて後から連続性を再導入する
- **エンジン**: open_questions() を H ベースからグラフ到達性ベースに書き換え

## 未決事項

- 3a の到達先 P_pred 一致条件は必要か（「かもしれない」の状態）
- R(P) 到達性の計算方法（1ホップか多ホップか、重み閾値）
- 段階性の再導入が必要になった場合の方法
